<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Daily DevOps</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <header class="container">
    <div class="brand">
      <div class="logo">⚙️</div>
      <div>
        <h1>Daily DevOps</h1>
        <p class="subtitle">משפט היום · טיפ היום · סרטונים · כלים · הדרכות</p>
      </div>
    </div>
  </header>

  <!-- DevOps-only search (client-side) -->
  <section class="search container">
    <div class="search-box ltr"><!-- Force LTR typing -->
      <input id="q" type="text" placeholder="חפש בעולם ה-DevOps (כלי, וידאו, מדריך)…" />
      <button id="btn">חפש</button>
    </div>
    <div id="results" class="results ltr"></div><!-- Results shown LTR -->
  </section>

  <main class="container grid">
    <!-- Quote of the Day -->
    <section class="card accent">
      <h2>משפט היום</h2>
      <p class="quote">“{{ quote }}”</p>
    </section>

    <!-- Tip of the Day -->
    <section class="card">
      <h2>טיפ DevOps של היום</h2>
      <h3 class="tip-title">{{ tip.title }}</h3>
      <p>{{ tip.body }}</p>
      <p class="source">
        מקור: <a href="{{ tip.url }}" target="_blank" rel="noopener">{{ tip.source }}</a>
      </p>
    </section>

    <!-- Videos -->
    <section class="card">
      <h2>סרטוני DevOps</h2>
      <div class="videos">
        {% for v in videos %}
        <div class="video">
          <div class="video-title">{{ v.title }}</div>
          <div class="video-frame">
            <iframe src="{{ v.embed }}" title="{{ v.title }}" frameborder="0" allowfullscreen></iframe>
          </div>
        </div>
        {% endfor %}
      </div>
    </section>

    <!-- Tools (mostly English → LTR) -->
    <section class="card ltr">
      <h2>כלים מומלצים</h2>
      <div class="tools">
        {% for t in tools %}
        <a class="tool" href="{{ t.url }}" target="_blank" rel="noopener">
          <div class="tool-name">{{ t.name }}</div>
          <div class="tool-desc">{{ t.desc }}</div>
        </a>
        {% endfor %}
      </div>
    </section>

    <!-- Learning (mostly English → LTR) -->
    <section class="card ltr">
      <h2>הדרכות וקישורי לימוד</h2>
      <ul class="learning">
        {% for l in learning %}
          <li><a href="{{ l.url }}" target="_blank" rel="noopener">{{ l.title }}</a> — {{ l.desc }}</li>
        {% endfor %}
      </ul>
    </section>
  </main>

  <footer class="container footer ltr"><!-- Footer in LTR/left -->
    <span>Deployed on Kubernetes · GitHub Actions CI/CD</span>
    <a href="https://github.com/{{ repo }}" target="_blank" rel="noopener">View on GitHub</a>
  </footer>

  <script>
  // DevOps-only search client (English-only comments)
  // This calls your FastAPI route /search?q=... (server must whitelist DevOps sources)
  async function runSearch() {
    const q = document.getElementById('q').value.trim();
    const box = document.getElementById('results');
    if (!q) { box.innerHTML = ''; return; }
    box.innerHTML = 'מחפש...';
    try {
      const r = await fetch('/search?q=' + encodeURIComponent(q));
      const data = await r.json();
      if (!data.results || !data.results.length) {
        box.innerHTML = '<p>לא נמצאו תוצאות.</p>';
        return;
      }
      box.innerHTML = data.results.map(item => `
        <div class="card">
          <small class="tag">${item.type || 'link'}</small>
          <a href="${item.url}" target="_blank" rel="noopener">
            <h4>${item.title || 'ללא כותרת'}</h4>
          </a>
          <p>${item.desc || ''}</p>
        </div>
      `).join('');
    } catch (e) {
      box.innerHTML = '<p>שגיאה בחיפוש.</p>';
    }
  }
  document.getElementById('btn').addEventListener('click', runSearch);
  document.getElementById('q').addEventListener('keydown', (e)=>{ if(e.key==='Enter') runSearch(); });
  </script>
</body>
</html>
